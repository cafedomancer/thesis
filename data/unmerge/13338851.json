{"issue_url": "https://api.github.com/repos/rails/rails/issues/9230", "repo": "rails", "body": "Interestingly it seems as though `String#==` is constant time on MRI 1.8.7 & 1.9.3:\r\n\r\n``` ruby\r\nrequire 'benchmark/ips'\r\n\r\nGC.disable\r\n\r\ndef secure_compare(a, b)\r\n  a == b\r\nend\r\n\r\nval1 = '1f9a12d8cacb4db86e75148b442c96150a5211a9'\r\nval2 = '1f9a12d8cacb4db86e75148b442c96150a5211a9'\r\nval3 = '2f9a12d8cacb4db86e75148b442c96150a5211a9'\r\n\r\nBenchmark.ips do |x|\r\n  x.report(\"same\") { secure_compare(val1, val2) }\r\n  x.report(\"diff\") { secure_compare(val1, val3) }\r\nend\r\n```\r\n``` sh\r\n$ ruby -r rubygems secure_compare.rb\r\nCalculating -------------------------------------\r\n                same     48360 i/100ms\r\n                diff     46273 i/100ms\r\n-------------------------------------------------\r\n                same  1375196.9 (\u00b16.6%) i/s -    6770400 in   5.013627s\r\n                diff  1388258.8 (\u00b17.3%) i/s -    6709585 in   5.022314s\r\n```\r\n``` sh\r\n$ ruby secure_compare.rb\r\nCalculating -------------------------------------\r\n                same     47408 i/100ms\r\n                diff     48297 i/100ms\r\n-------------------------------------------------\r\n                same  2197307.6 (\u00b11.3%) i/s -   10998656 in   5.006463s\r\n                diff  2350030.9 (\u00b11.3%) i/s -   11784468 in   5.015437s\r\n```", "_id": {"$oid": "5237ebebbd3543c151009c03"}, "issue_id": 9230, "url": "https://api.github.com/repos/rails/rails/issues/comments/13338851", "html_url": "https://github.com/rails/rails/pull/9230#issuecomment-13338851", "updated_at": "2013-02-09T21:13:50Z", "user": {"subscriptions_url": "https://api.github.com/users/pixeltrix/subscriptions", "events_url": "https://api.github.com/users/pixeltrix/events{/privacy}", "repos_url": "https://api.github.com/users/pixeltrix/repos", "gists_url": "https://api.github.com/users/pixeltrix/gists{/gist_id}", "url": "https://api.github.com/users/pixeltrix", "login": "pixeltrix", "gravatar_id": "b14001f2b40640dd6cb63f0e8f1f4869", "html_url": "https://github.com/pixeltrix", "following_url": "https://api.github.com/users/pixeltrix/following{/other_user}", "received_events_url": "https://api.github.com/users/pixeltrix/received_events", "organizations_url": "https://api.github.com/users/pixeltrix/orgs", "avatar_url": "https://0.gravatar.com/avatar/b14001f2b40640dd6cb63f0e8f1f4869?d=https%3A%2F%2Fidenticons.github.com%2F7cb36e23529e4de4c41460940cc85e6e.png", "starred_url": "https://api.github.com/users/pixeltrix/starred{/owner}{/repo}", "id": 6321, "followers_url": "https://api.github.com/users/pixeltrix/followers", "type": "User"}, "created_at": "2013-02-09T21:13:50Z", "id": 13338851, "owner": "rails"}
