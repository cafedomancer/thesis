{"issue_url": "https://api.github.com/repos/rails/rails/issues/6401", "repo": "rails", "body": "@wycats - I was observing empirically with a clean generated rails app (with threadsafe mode enabled) that the templates aren't compiled ahead of time. They're compiled on demand, and if there are multiple requests for the same url when it is first requested then you can get two threads going through the compile process at the same time. I verified this by instrumenting the code. And verified that the fix, serializes the access and makes sure a particular template gets compiled precisely once.\n\nIn practice I've had this happen several times on a production app, where a particular url is permanently damaged, and unable to be used until the next server restart.\n\nI wasn't aware of any functionality that allowed templates to be compiled ahead of time - is there such a thing? If so that would be a satisfactory solution.", "_id": {"$oid": "523e5c02bd354364b900f6b1"}, "issue_id": 6401, "url": "https://api.github.com/repos/rails/rails/issues/comments/5806575", "html_url": "https://github.com/rails/rails/pull/6401#issuecomment-5806575", "updated_at": "2012-05-20T04:30:22Z", "user": {"subscriptions_url": "https://api.github.com/users/pinetops/subscriptions", "events_url": "https://api.github.com/users/pinetops/events{/privacy}", "repos_url": "https://api.github.com/users/pinetops/repos", "gists_url": "https://api.github.com/users/pinetops/gists{/gist_id}", "url": "https://api.github.com/users/pinetops", "login": "pinetops", "gravatar_id": "7550f06afec9b1ffffa7687c5e2b93d8", "html_url": "https://github.com/pinetops", "following_url": "https://api.github.com/users/pinetops/following{/other_user}", "received_events_url": "https://api.github.com/users/pinetops/received_events", "organizations_url": "https://api.github.com/users/pinetops/orgs", "avatar_url": "https://0.gravatar.com/avatar/7550f06afec9b1ffffa7687c5e2b93d8?d=https%3A%2F%2Fidenticons.github.com%2F1046b70c80e922db36d9b2d6f733ce52.png", "starred_url": "https://api.github.com/users/pinetops/starred{/owner}{/repo}", "id": 28485, "followers_url": "https://api.github.com/users/pinetops/followers", "type": "User"}, "created_at": "2012-05-20T04:24:18Z", "id": 5806575, "owner": "rails"}
