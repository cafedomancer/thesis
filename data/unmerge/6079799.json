{"body": "Thanks for the clarification.\n\nThe new test passes when conditional fragment caching works, but when it is not I get an error instead of 2 failed assertions:\n\n```\n1) Error:\ntest_conditional_fragment_caching(FragmentCachingTest):\nNoMethodError: undefined method `<<' for nil:NilClass\n    /Users/sausman/github/rails/actionpack/lib/action_view/helpers/text_helper.rb:52:in `concat'\n    /Users/sausman/github/rails/actionpack/lib/action_view/helpers/text_helper.rb:56:in `safe_concat'\n    /Users/sausman/github/rails/actionpack/lib/action_view/helpers/cache_helper.rb:35:in `cache'\n    /Users/sausman/github/rails/actionpack/test/controller/caching_test.rb:857:in `test_conditional_fragment_caching'\n    /Users/sausman/.rvm/gems/ruby-1.9.3-p0/gems/mocha-0.11.4/lib/mocha/integration/mini_test/version_230_to_262.rb:28:in `run'\n    /Users/sausman/github/rails/activesupport/lib/active_support/testing/setup_and_teardown.rb:37:in `block in run'\n    /Users/sausman/github/rails/activesupport/lib/active_support/callbacks.rb:377:in `_run_callbacks_70326160161660'\n    /Users/sausman/github/rails/activesupport/lib/active_support/callbacks.rb:75:in `run_callbacks'\n    /Users/sausman/github/rails/activesupport/lib/active_support/testing/setup_and_teardown.rb:36:in `run'\n```\n\nI think `fragment_for` is returning nil when called within `cache`, but I wasn't able to find out why.", "url": "https://api.github.com/repos/rails/rails/issues/comments/6079799", "created_at": "2012-06-02T18:47:45Z", "html_url": "https://github.com/rails/rails/pull/5396#issuecomment-6079799", "updated_at": "2012-06-02T18:47:45Z", "repo": "rails", "issue_id": 5396, "user": {"following_url": "https://api.github.com/users/sausman/following{/other_user}", "events_url": "https://api.github.com/users/sausman/events{/privacy}", "organizations_url": "https://api.github.com/users/sausman/orgs", "url": "https://api.github.com/users/sausman", "gists_url": "https://api.github.com/users/sausman/gists{/gist_id}", "html_url": "https://github.com/sausman", "subscriptions_url": "https://api.github.com/users/sausman/subscriptions", "avatar_url": "https://2.gravatar.com/avatar/03bcc4174eb7d5e951345f17551eac2e?d=https%3A%2F%2Fidenticons.github.com%2Fe2d8652441a60971c8af20d74e3598e7.png", "repos_url": "https://api.github.com/users/sausman/repos", "received_events_url": "https://api.github.com/users/sausman/received_events", "gravatar_id": "03bcc4174eb7d5e951345f17551eac2e", "starred_url": "https://api.github.com/users/sausman/starred{/owner}{/repo}", "login": "sausman", "type": "User", "id": 309638, "followers_url": "https://api.github.com/users/sausman/followers"}, "owner": "rails", "_id": {"$oid": "523818cbbd3543c15100e0de"}, "id": 6079799, "issue_url": "https://api.github.com/repos/rails/rails/issues/5396"}
