{"body": "Here is Simon's comments:\n\nChanging the schema of a RDBS and deploying the dependent code should be performed with great care, the basic concept of each migration being \"whole\" change keeps things tidy.  Giving any impression to a developer that enclosing a bunch of migrations as a transaction creates a highly-available deploy would be a disservice.  There are so many other factors that go into making HA happen.   Very few sites actually require anything close to HA, those that do are going to be putting all sorts of tools around their deploy process.\n\nThe suggested code/schema upgrade should go this way, hopefully in as short a period as possible, with some sanity checks between each step:\nDisable website\nDump current database\nMigrate database\nUpdate code\nRe-enable website\n\nLets say there were 10 migrations to do and #5 failed, being in the state that 1-4 have run is where you want to be.  Now you can look at why #5 failed, fix it (check it in), and continue.\n\nThis becomes particularly important if one of 1-4 were very long running statements, large import, index updating, etc.  In these cases it becomes even more important that the website be shut down because the DB is going to be pinning its CPU and the user experience is going to suffer dramatically.\n\nIf the change was implemented I would suggest that it be off by default in development, where the situation of wanting the first few migrations to take and then to begin debugging is the much more normal behaviour.", "url": "https://api.github.com/repos/rails/rails/issues/comments/6442750", "created_at": "2012-06-20T01:09:02Z", "html_url": "https://github.com/rails/rails/pull/6768#issuecomment-6442750", "updated_at": "2012-06-20T01:09:02Z", "repo": "rails", "issue_id": 6768, "user": {"following_url": "https://api.github.com/users/rosenfeld/following{/other_user}", "events_url": "https://api.github.com/users/rosenfeld/events{/privacy}", "organizations_url": "https://api.github.com/users/rosenfeld/orgs", "url": "https://api.github.com/users/rosenfeld", "gists_url": "https://api.github.com/users/rosenfeld/gists{/gist_id}", "html_url": "https://github.com/rosenfeld", "subscriptions_url": "https://api.github.com/users/rosenfeld/subscriptions", "avatar_url": "https://0.gravatar.com/avatar/2abdb50caf0dc5b510330f68b02db8e4?d=https%3A%2F%2Fidenticons.github.com%2F7c3aa93f86af77d8b1071d5fd2b4c91a.png", "repos_url": "https://api.github.com/users/rosenfeld/repos", "received_events_url": "https://api.github.com/users/rosenfeld/received_events", "gravatar_id": "2abdb50caf0dc5b510330f68b02db8e4", "starred_url": "https://api.github.com/users/rosenfeld/starred{/owner}{/repo}", "login": "rosenfeld", "type": "User", "id": 32246, "followers_url": "https://api.github.com/users/rosenfeld/followers"}, "owner": "rails", "_id": {"$oid": "52380449bd3543c15100c599"}, "id": 6442750, "issue_url": "https://api.github.com/repos/rails/rails/issues/6768"}
