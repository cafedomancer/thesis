{"issue_url": "https://api.github.com/repos/rails/rails/issues/4165", "repo": "rails", "body": "\r\n\r\nSetting up the configuration is straight forward: \r\n\r\nactive_record/lib/active_record/base.rb\r\n\r\n```ruby\r\n\r\n##\r\n# :singleton-method:\r\n# Specify how to notify the user when pending migrations are detected\r\n# use :warn, :error, or :none\r\ncattr_accessor :on_pending_migration , :instance_writer => false\r\n@@on_pending_migration = :none\r\n\r\n```\r\n\r\n\r\nThen actually raising/warning the message is straightforward\r\n\r\n```ruby\r\n\r\n# Notifies the developer if there are pending migrations\r\n# the type of notification can be configured. Example:\r\n#\r\n#   config.active_record.on_pending_migration = :error\r\ndef notify_pending_migrations\r\n  case ActiveRecord::Base.on_pending_migration\r\n  when :error\r\n    raise ActiveRecordError::PendingMigration, \"There are pending migrations run 'bundle exec rake db:migrate' to resolve them\" if ActiveRecord::Migrator.needs_migration?\r\n  when :warn\r\n    warn \"There are pending migrations run 'bundle exec rake db:migrate' to resolve them\" if ActiveRecord::Migrator.needs_migration?\r\n  end\r\nend\r\n\r\n```\r\n\r\n\r\nThe thing I'm unsure of is where to call `notify_pending_migrations`. Since migrations are an ActiveRecord specific concept, I would like to keep the code within AR (not rely on a controller/view/etc. to relay the message). It also needs to work in the console and when running on a server. If we don't check _every_ round trip to the server we can't be sure that new migrations haven't been introduced. So we could hook into something like  `ActiveRecord::Base.table_name` that gets called on each round trip to the DB, though that would be a lot of redundant checks. Perhaps there is a better place to do the check?", "_id": {"$oid": "52382bb5bd3543c15100f14f"}, "issue_id": 4165, "url": "https://api.github.com/repos/rails/rails/issues/comments/3897192", "html_url": "https://github.com/rails/rails/pull/4165#issuecomment-3897192", "updated_at": "2012-02-09T22:32:39Z", "user": {"subscriptions_url": "https://api.github.com/users/schneems/subscriptions", "events_url": "https://api.github.com/users/schneems/events{/privacy}", "repos_url": "https://api.github.com/users/schneems/repos", "gists_url": "https://api.github.com/users/schneems/gists{/gist_id}", "url": "https://api.github.com/users/schneems", "login": "schneems", "gravatar_id": "db953d125f5cc49756edb6149f1b813e", "html_url": "https://github.com/schneems", "following_url": "https://api.github.com/users/schneems/following{/other_user}", "received_events_url": "https://api.github.com/users/schneems/received_events", "organizations_url": "https://api.github.com/users/schneems/orgs", "avatar_url": "https://0.gravatar.com/avatar/db953d125f5cc49756edb6149f1b813e?d=https%3A%2F%2Fidenticons.github.com%2F6ef42a6eab211ddd71ac423a80b42d15.png", "starred_url": "https://api.github.com/users/schneems/starred{/owner}{/repo}", "id": 59744, "followers_url": "https://api.github.com/users/schneems/followers", "type": "User"}, "created_at": "2012-02-09T22:32:39Z", "id": 3897192, "owner": "rails"}
