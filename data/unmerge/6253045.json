{"body": "@nahi if we are relying on atomicity of `Hash#[]=` (or any other non-threadsafe data structure), I consider it a bug.\n\nI think the `threadsafe!` flag is misleading.  When you have threadsafe disabled, you're saying \"I'm OK with running a non-deterministic system\".  Most people are **not** OK with running a non-deterministic system, they just **don't know it will become non-deterministic** (even in MRI) when threads are introduced.  We cannot restrict users or libraries from using threads, and requiring people to a) track down that some library (or some user code) is using threads, then b) flip a magic switch that makes everything OK again seems like an unacceptable default.\n\nMy true opinion is that Rails should just always be threadsafe and the config flag is removed.  But defaulting to threadsafe in the config settings seems like the most conservative approach for Rails 4.\n\n* If code is slow, let's make it fast.\n* If code is not threadsafe, let's make it threadsafe.\n\nWe have to do those things anyway, let's not do it half way.", "url": "https://api.github.com/repos/rails/rails/issues/comments/6253045", "created_at": "2012-06-11T19:05:42Z", "html_url": "https://github.com/rails/rails/pull/6685#issuecomment-6253045", "updated_at": "2012-06-11T19:05:42Z", "repo": "rails", "issue_id": 6685, "user": {"following_url": "https://api.github.com/users/tenderlove/following{/other_user}", "events_url": "https://api.github.com/users/tenderlove/events{/privacy}", "organizations_url": "https://api.github.com/users/tenderlove/orgs", "url": "https://api.github.com/users/tenderlove", "gists_url": "https://api.github.com/users/tenderlove/gists{/gist_id}", "html_url": "https://github.com/tenderlove", "subscriptions_url": "https://api.github.com/users/tenderlove/subscriptions", "avatar_url": "https://0.gravatar.com/avatar/f29327647a9cff5c69618bae420792ea?d=https%3A%2F%2Fidenticons.github.com%2F7c78335a8924215ea5c22fda1aac7b75.png", "repos_url": "https://api.github.com/users/tenderlove/repos", "received_events_url": "https://api.github.com/users/tenderlove/received_events", "gravatar_id": "f29327647a9cff5c69618bae420792ea", "starred_url": "https://api.github.com/users/tenderlove/starred{/owner}{/repo}", "login": "tenderlove", "type": "User", "id": 3124, "followers_url": "https://api.github.com/users/tenderlove/followers"}, "owner": "rails", "_id": {"$oid": "52380552bd3543c15100c6ee"}, "id": 6253045, "issue_url": "https://api.github.com/repos/rails/rails/issues/6685"}
