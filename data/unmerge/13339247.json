{"updated_at": "2013-02-09T21:39:55Z", "repo": "rails", "created_at": "2013-02-09T21:39:55Z", "owner": "rails", "url": "https://api.github.com/repos/rails/rails/issues/comments/13339247", "id": 13339247, "issue_url": "https://api.github.com/repos/rails/rails/issues/9230", "issue_id": 9230, "user": {"repos_url": "https://api.github.com/users/headius/repos", "type": "User", "html_url": "https://github.com/headius", "starred_url": "https://api.github.com/users/headius/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/headius/subscriptions", "following_url": "https://api.github.com/users/headius/following{/other_user}", "gravatar_id": "f1d37642fdaa1662ff46e4c65731e9ab", "organizations_url": "https://api.github.com/users/headius/orgs", "url": "https://api.github.com/users/headius", "gists_url": "https://api.github.com/users/headius/gists{/gist_id}", "avatar_url": "https://2.gravatar.com/avatar/f1d37642fdaa1662ff46e4c65731e9ab?d=https%3A%2F%2Fidenticons.github.com%2F36bedb6eb7152f39b16328448942822b.png", "id": 10135, "events_url": "https://api.github.com/users/headius/events{/privacy}", "login": "headius", "received_events_url": "https://api.github.com/users/headius/received_events", "followers_url": "https://api.github.com/users/headius/followers"}, "body": "@pixeltrix You may just not bee seeing the difference because the string is short and Ruby's own overhead obscures it in this benchmark. I modified your benchmark to make the strings longer, call == directly, and do it a few times per ips loop and the difference is clear:\r\n\r\n```ruby\r\nrequire 'benchmark/ips'\r\n\r\nGC.disable\r\n\r\ndef secure_compare(a, b)\r\n  a == b\r\nend\r\n\r\nval1 = '11f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a9f9a12d8cacb4db86e75148b442c96150a5211a9'\r\nval2 = '11f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a9f9a12d8cacb4db86e75148b442c96150a5211a9'\r\nval3 = '21f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a91f9a12d8cacb4db86e75148b442c96150a5211a9f9a12d8cacb4db86e75148b442c96150a5211a9'\r\n\r\nBenchmark.ips do |x|\r\n  x.report(\"same\") do\r\n    val1 == val2\r\n    val1 == val2\r\n    val1 == val2\r\n    val1 == val2\r\n    val1 == val2\r\n  end\r\n  x.report(\"diff\") do\r\n    val1 == val3\r\n    val1 == val3\r\n    val1 == val3\r\n    val1 == val3\r\n    val1 == val3\r\n  end\r\nend\r\n```\r\n\r\nNumbers:\r\n\r\n```\r\nCalculating -------------------------------------\r\n                same     53389 i/100ms\r\n                diff     77215 i/100ms\r\n-------------------------------------------------\r\n                same   974922.1 (\u00b13.4%) i/s -    4911788 in   5.044732s\r\n                diff  2429804.4 (\u00b12.7%) i/s -   12199970 in   5.024842s\r\n```", "_id": {"$oid": "5237ebebbd3543c151009c04"}, "html_url": "https://github.com/rails/rails/pull/9230#issuecomment-13339247"}
