{"body": "I basically came to the same conclusion as @pixeltrix.  I think the best solution is to have separate callback chains for these purposes.  Here's why:\r\n\r\n1. If we try to make <code>save_collection_association</code> smart enough to handle this situation, it'll be really ugly.  The hack is certainly possible, but it's inexcusably ugly.\r\n2. If we try to force the right ordering by some sort of special case, that doesn't help at all in solving other instances where there might be problems of this sort.\r\n\r\nThe downsides I can see:\r\n\r\n1. By default, all callback chains are publicly exposed.  If people start using the callback chains we add in their code, these sorts of problems could happen again.  Then it turns into a sort of arms race for which callback chain is REALLY first or last.\r\n2. Aside from the public use scenario, in general proliferation of callback chains inside the same callback management code seems inelegant to me.\r\n\r\nOne final alternative that presents itself to me is to have an entirely separate, not publicly exposed, set of callback chains.  Of course, this could be enforced more by code (of course, anyone can actually access them if they really want) or more by convention (documented as \"don't touch unless you really know what you're doing\").  A \"separate set\" is flexible concept, of course, so it could mean separate objects managing it, or a conceptually distinct set, managed by the same code, but distinct by convention.\r\n\r\nI'm working on the separate by convention approach right now to see how the code turns out.  If everyone is radically opposed to that, I'll stop and move on to something else.", "url": "https://api.github.com/repos/rails/rails/issues/comments/14860487", "created_at": "2013-03-13T18:39:35Z", "html_url": "https://github.com/rails/rails/pull/8674#issuecomment-14860487", "updated_at": "2013-03-13T18:39:35Z", "repo": "rails", "issue_id": 8674, "user": {"following_url": "https://api.github.com/users/tehgeekmeister/following{/other_user}", "events_url": "https://api.github.com/users/tehgeekmeister/events{/privacy}", "organizations_url": "https://api.github.com/users/tehgeekmeister/orgs", "url": "https://api.github.com/users/tehgeekmeister", "gists_url": "https://api.github.com/users/tehgeekmeister/gists{/gist_id}", "html_url": "https://github.com/tehgeekmeister", "subscriptions_url": "https://api.github.com/users/tehgeekmeister/subscriptions", "avatar_url": "https://2.gravatar.com/avatar/9e0096ad9f376eb9f609372bc87542e4?d=https%3A%2F%2Fidenticons.github.com%2F8aa6d8da22a168889f76c9a5a6e5fa84.png", "repos_url": "https://api.github.com/users/tehgeekmeister/repos", "received_events_url": "https://api.github.com/users/tehgeekmeister/received_events", "gravatar_id": "9e0096ad9f376eb9f609372bc87542e4", "starred_url": "https://api.github.com/users/tehgeekmeister/starred{/owner}{/repo}", "login": "tehgeekmeister", "type": "User", "id": 114833, "followers_url": "https://api.github.com/users/tehgeekmeister/followers"}, "owner": "rails", "_id": {"$oid": "5237f115bd3543c15100a3ad"}, "id": 14860487, "issue_url": "https://api.github.com/repos/rails/rails/issues/8674"}
