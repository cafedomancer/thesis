{"issue_url": "https://api.github.com/repos/rails/rails/issues/5418", "repo": "rails", "body": "@rohit I think it's not necessary to remove that line, otherwise we'll be also triggering BCrypt with blank passwords =).\r\n\r\nI have to disagree on validating `password_digest` as well, seems like the validation should go to the `password` accessor. However, if we just add a presence validation, it'll fail hard in scenarios like an \"edit profile form\", where the user has the password field to be updated but want to leave it blank to not change it. With the presence validation in place, the developer would have to remove the password attribute before calling something like `update_attributes`.\r\n\r\nThe issue you mention uses, that seems quite reasonable:\r\n\r\n```ruby\r\nvalidates :password, :presence => { :on => :create }\r\n```\r\n\r\nA good combination might be:\r\n\r\n```ruby\r\nvalidates :password, presence: { :on => :create }, confirmation: { :allow_blank => true }\r\n```\r\n\r\nThis works when creating the record, enforcing a password, but allows blank values when updating. The possible \"drawback\" is that you can update the password without giving the confirmation (I mean manually, if it's nil, it doesn't trigger).\r\n\r\nCan't think about possibilities other than what @josevalim mentioned.\r\n\r\n(btw, there is also the attr_accessible issue now that it is enforced, but that's another story :)", "_id": {"$oid": "5238185fbd3543c15100e055"}, "issue_id": 5418, "url": "https://api.github.com/repos/rails/rails/issues/comments/4533294", "html_url": "https://github.com/rails/rails/pull/5418#issuecomment-4533294", "updated_at": "2012-03-16T02:48:53Z", "user": {"subscriptions_url": "https://api.github.com/users/carlosantoniodasilva/subscriptions", "events_url": "https://api.github.com/users/carlosantoniodasilva/events{/privacy}", "repos_url": "https://api.github.com/users/carlosantoniodasilva/repos", "gists_url": "https://api.github.com/users/carlosantoniodasilva/gists{/gist_id}", "url": "https://api.github.com/users/carlosantoniodasilva", "login": "carlosantoniodasilva", "gravatar_id": "77237b97a465ae5a293ad323b7296837", "html_url": "https://github.com/carlosantoniodasilva", "following_url": "https://api.github.com/users/carlosantoniodasilva/following{/other_user}", "received_events_url": "https://api.github.com/users/carlosantoniodasilva/received_events", "organizations_url": "https://api.github.com/users/carlosantoniodasilva/orgs", "avatar_url": "https://1.gravatar.com/avatar/77237b97a465ae5a293ad323b7296837?d=https%3A%2F%2Fidenticons.github.com%2F60b997fd68261ce70cadaf6c8226c042.png", "starred_url": "https://api.github.com/users/carlosantoniodasilva/starred{/owner}{/repo}", "id": 26328, "followers_url": "https://api.github.com/users/carlosantoniodasilva/followers", "type": "User"}, "created_at": "2012-03-16T02:48:53Z", "id": 4533294, "owner": "rails"}
