{"body": "@revans I disagree that the intention should be about time taken.\r\n\r\nThe point is to make it extremely difficult for attackers to guess passwords en masse while not excessively loading your own server. Some attacks are against the API endpoint; in this case one good approach is an explicit rate-limit, rather than an implicit rate-limit because all your servers are overloaded with computing bcrypt hashes, so you should measure a cost which turns out to be slow but not unacceptably slow and use that. Other attacks are against stolen password files; in this case there is no good relationship between time on your machine and time on the attacker's, which probably has more cores and memory than you, so you should measure a cost which turns out to be slow but not unacceptably slow for you and use that. You should do these measurements in controlled environments.\r\n\r\nThe key here is \"turns out\" - the intention is a universally-recognized numeric cost which has a certain effect in a certain case on a certain machine that works out to your liking.\r\n\r\nThere is also the issue that if randomly one time when your server is booting, it happens to have extremely high load temporarily, and the rails app boots up and calibrates to 1s but because the machine is so loaded the calibrated cost turns out to be very low. That can be a nice security problem. It's much better to hardcode a numeric cost in your application so that you're sure that random things like temporary high load cannot cause weak hashes.\r\n\r\nSo it's the numeric cost that is important, not the time taken on your machine randomly. You can relate the numeric cost to time taken in a controlled experiment in a controlled environment, but not to time taken in the wild where random fluctuations can pollute the result.\r\n", "url": "https://api.github.com/repos/rails/rails/issues/comments/11007505", "created_at": "2012-12-04T17:56:17Z", "html_url": "https://github.com/rails/rails/pull/8408#issuecomment-11007505", "updated_at": "2012-12-04T17:56:17Z", "repo": "rails", "issue_id": 8408, "user": {"following_url": "https://api.github.com/users/yfeldblum/following{/other_user}", "events_url": "https://api.github.com/users/yfeldblum/events{/privacy}", "organizations_url": "https://api.github.com/users/yfeldblum/orgs", "url": "https://api.github.com/users/yfeldblum", "gists_url": "https://api.github.com/users/yfeldblum/gists{/gist_id}", "html_url": "https://github.com/yfeldblum", "subscriptions_url": "https://api.github.com/users/yfeldblum/subscriptions", "avatar_url": "https://0.gravatar.com/avatar/5eadf00e11240f05263ec7735612cd09?d=https%3A%2F%2Fidenticons.github.com%2F485970c473e9165d1649e16c7aa35b83.png", "repos_url": "https://api.github.com/users/yfeldblum/repos", "received_events_url": "https://api.github.com/users/yfeldblum/received_events", "gravatar_id": "5eadf00e11240f05263ec7735612cd09", "starred_url": "https://api.github.com/users/yfeldblum/starred{/owner}{/repo}", "login": "yfeldblum", "type": "User", "id": 169419, "followers_url": "https://api.github.com/users/yfeldblum/followers"}, "owner": "rails", "_id": {"$oid": "523d9148bd354364b9007df9"}, "id": 11007505, "issue_url": "https://api.github.com/repos/rails/rails/issues/8408"}
