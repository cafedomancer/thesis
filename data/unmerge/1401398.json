{"issue_url": "https://api.github.com/repos/rails/rails/issues/1729", "repo": "rails", "body": "The reason for the _html feature in I18n is specifically so that HTML code can be localized - if there's no HTML don't use _html for a key. You're correct in saying that underscore shouldn't have to worry about whether the argument is HTML or not and that's the root of the problem - should SafeBuffer be like a String or not, i.e. should we use inheritance or composition. \r\n\r\nWith the benefit of hindsight it'd probably been better if was clear that SafeBuffer is not a string - once you've modified it with anything like gsub then you have to treat it as dirty and escape the whole string again which is likely to lead to unexpected double escaping bugs. The most you should be able to do with a SafeBuffer is concat together with another String (in which case the String is escaped)  or with another SafeBuffer (in which case no extra escaping is performed). I'd probably go so far as to add a warning similar to the warning raised when a mass-assignment variable is ignored when a SafeBuffer is converted to a string.\r\n\r\nI think the method name of html_safe has partly led to the confusion over how SafeBuffer is meant to be used - people have been using to say \"this string doesn't contain anything dangerous\" where what it really means is \"this string may contain HTML code that's already been escaped, don't escape it again\". This has led to people using it pre-emptively in their helpers - the only time you should be calling html_safe in your helpers is if you're building chunks of HTML. Even then you probably don't need to call html_safe if you're using tag, content_tag, etc.", "_id": {"$oid": "5238502bbd3543c1510116b5"}, "issue_id": 1729, "url": "https://api.github.com/repos/rails/rails/issues/comments/1401398", "html_url": "https://github.com/rails/rails/pull/1729#issuecomment-1401398", "updated_at": "2011-06-20T08:51:25Z", "user": {"subscriptions_url": "https://api.github.com/users/pixeltrix/subscriptions", "events_url": "https://api.github.com/users/pixeltrix/events{/privacy}", "repos_url": "https://api.github.com/users/pixeltrix/repos", "gists_url": "https://api.github.com/users/pixeltrix/gists{/gist_id}", "url": "https://api.github.com/users/pixeltrix", "login": "pixeltrix", "gravatar_id": "b14001f2b40640dd6cb63f0e8f1f4869", "html_url": "https://github.com/pixeltrix", "following_url": "https://api.github.com/users/pixeltrix/following{/other_user}", "received_events_url": "https://api.github.com/users/pixeltrix/received_events", "organizations_url": "https://api.github.com/users/pixeltrix/orgs", "avatar_url": "https://2.gravatar.com/avatar/b14001f2b40640dd6cb63f0e8f1f4869?d=https%3A%2F%2Fidenticons.github.com%2F7cb36e23529e4de4c41460940cc85e6e.png", "starred_url": "https://api.github.com/users/pixeltrix/starred{/owner}{/repo}", "id": 6321, "followers_url": "https://api.github.com/users/pixeltrix/followers", "type": "User"}, "created_at": "2011-06-20T08:51:25Z", "id": 1401398, "owner": "rails"}
