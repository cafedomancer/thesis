{"updated_at": "2013-06-04T22:51:15Z", "repo": "rails", "created_at": "2013-06-04T15:13:09Z", "owner": "rails", "url": "https://api.github.com/repos/rails/rails/issues/comments/18915777", "id": 18915777, "issue_url": "https://api.github.com/repos/rails/rails/issues/10830", "issue_id": 10830, "user": {"repos_url": "https://api.github.com/users/mrbrdo/repos", "type": "User", "html_url": "https://github.com/mrbrdo", "starred_url": "https://api.github.com/users/mrbrdo/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/mrbrdo/subscriptions", "following_url": "https://api.github.com/users/mrbrdo/following{/other_user}", "gravatar_id": "eda6e2638857d20ae499d26432e1a221", "organizations_url": "https://api.github.com/users/mrbrdo/orgs", "url": "https://api.github.com/users/mrbrdo", "gists_url": "https://api.github.com/users/mrbrdo/gists{/gist_id}", "avatar_url": "https://1.gravatar.com/avatar/eda6e2638857d20ae499d26432e1a221?d=https%3A%2F%2Fidenticons.github.com%2Fa767c168a69e9b80282f6d93b32fbb05.png", "id": 167990, "events_url": "https://api.github.com/users/mrbrdo/events{/privacy}", "login": "mrbrdo", "received_events_url": "https://api.github.com/users/mrbrdo/received_events", "followers_url": "https://api.github.com/users/mrbrdo/followers"}, "body": "@rafaelfranca ok this was a bit hard to track down but I found it. It is really a difference between Rails 3 and 4 as I was able to reproduce in sample app too (only rails and pg gem). It has to do with the serialize method.\r\n\r\nIf you really want I can give you the sample app but I think you will be able to figure it out quicker by just this description:\r\n- say I have a bytea field and I use serialize like so\r\n\r\n````ruby\r\nclass Car < ActiveRecord::Base\r\n  class MySerializer\r\n    def self.load(string)\r\n      string.to_s\r\n    end\r\n\r\n    def self.dump(string)\r\n      string.to_s\r\n    end\r\n  end\r\n\r\n  serialize :testing, MySerializer\r\nend\r\n````\r\n\r\n- in Rails 4 the serializer will receive the raw string into load (same as I get from `connection.execute`)\r\n- in Rails 3 the serializer will receive (it seems) PGconn.unescape_bytea(string) into load\r\n- basically it seems Rails 4 doesn't unescape the result if you're using a serializer, but it does unescape it when not using a serializer\r\n- PS: It might depend on the data itself if these 2 will be different (could be that you need more complex binary data to see the difference)\r\n- I did not test how dump behaves in this case (i.e. if serializer is responsible to escape the string to bytea), need to consider this potential issue too\r\n\r\nIn case this is an intentional improvement of some sort, could you please let me know in which cases this behavior changed from Rails 3 so I can properly update my production data so Rails 4 can read it.", "_id": {"$oid": "5237db14bd3543c1510087d3"}, "html_url": "https://github.com/rails/rails/pull/10830#issuecomment-18915777"}
