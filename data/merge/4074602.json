{"issue_url": "https://api.github.com/repos/rails/rails/issues/4911", "repo": "rails", "body": "Just checked on Linux\r\n\r\n```\r\n2.6.38-13-generic #54-Ubuntu SMP Tue Jan 3 13:38:12 UTC 2012 x86_64 x86_64 x86_64 GNU/Linux\r\nNatty\r\n```\r\n\r\nin my case\r\nOn Encrypted FS(Cryptfs):\r\n\r\n```\r\ntest will fail on filename size >= 144\r\nAnd will pass on FILENAME_MAX_SIZE = 143\r\n```\r\n\r\nUbuntu community says that is known filesize bug (on cryptfs) and filesize on current dir underlying fs cannot be determined by syscalls from ruby.\r\nThis is related to @tenderlove conversation with Motohiro KOSAKI & Yui NARUSE\r\non https://bugs.ruby-lang.org/issues/5974\r\n\r\nOn Ext4 unencrypted:\r\n\r\n```\r\ntest will pass on 230 as expected\r\n```\r\n\r\n\r\nOn FreeBSD UFS unencrypted tests passed on FILENAME_MAX_SIZE = 230 \r\n\r\nWhat about cryptfs on Linux - current FILENAME_MAX_SIZE value will make cache files with long names(usually escaped utf strings) unusable before it hooked and truncated by rails.cache api calls\r\n\r\n* Maybe it will be useful to make a hash of limits + fs byte overheads for each FS. But IMO this will be very ugly :)\r\n* Or get a lowest limit on filename size - 143 for ecryptfs and use it for FILENAME_MAX_SIZE - this is ugly too IMO :(\r\n\r\nIn my particular case - i only can use a constant override to decrease FILENAME_MAX_SIZE to use a cache on dev and prod machines with cryptfs :( Sad\r\n\r\n\r\n\r\n\r\n", "_id": {"$oid": "52381f93bd3543c15100e80e"}, "issue_id": 4911, "url": "https://api.github.com/repos/rails/rails/issues/comments/4074602", "html_url": "https://github.com/rails/rails/pull/4911#issuecomment-4074602", "updated_at": "2012-02-23T11:28:26Z", "user": {"subscriptions_url": "https://api.github.com/users/kalabiyau/subscriptions", "events_url": "https://api.github.com/users/kalabiyau/events{/privacy}", "repos_url": "https://api.github.com/users/kalabiyau/repos", "gists_url": "https://api.github.com/users/kalabiyau/gists{/gist_id}", "url": "https://api.github.com/users/kalabiyau", "login": "kalabiyau", "gravatar_id": "abc326a22518dfaa478dd9a1240d2898", "html_url": "https://github.com/kalabiyau", "following_url": "https://api.github.com/users/kalabiyau/following{/other_user}", "received_events_url": "https://api.github.com/users/kalabiyau/received_events", "organizations_url": "https://api.github.com/users/kalabiyau/orgs", "avatar_url": "https://2.gravatar.com/avatar/abc326a22518dfaa478dd9a1240d2898?d=https%3A%2F%2Fidenticons.github.com%2Fcf8c9317d2396557dfd704ee1ba45e3e.png", "starred_url": "https://api.github.com/users/kalabiyau/starred{/owner}{/repo}", "id": 294998, "followers_url": "https://api.github.com/users/kalabiyau/followers", "type": "User"}, "created_at": "2012-02-21T13:26:27Z", "id": 4074602, "owner": "rails"}
