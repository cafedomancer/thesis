{"updated_at": "2012-02-29T14:05:52Z", "repo": "rails", "created_at": "2012-02-29T14:05:52Z", "owner": "rails", "url": "https://api.github.com/repos/rails/rails/issues/comments/4237887", "id": 4237887, "issue_url": "https://api.github.com/repos/rails/rails/issues/5208", "issue_id": 5208, "user": {"repos_url": "https://api.github.com/users/fxn/repos", "type": "User", "html_url": "https://github.com/fxn", "starred_url": "https://api.github.com/users/fxn/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/fxn/subscriptions", "following_url": "https://api.github.com/users/fxn/following{/other_user}", "gravatar_id": "7223c62b7310e164eb79c740188abbda", "organizations_url": "https://api.github.com/users/fxn/orgs", "url": "https://api.github.com/users/fxn", "gists_url": "https://api.github.com/users/fxn/gists{/gist_id}", "avatar_url": "https://1.gravatar.com/avatar/7223c62b7310e164eb79c740188abbda?d=https%3A%2F%2Fidenticons.github.com%2F4a11654ad1e1e48352252859ff3032a0.png", "id": 3387, "events_url": "https://api.github.com/users/fxn/events{/privacy}", "login": "fxn", "received_events_url": "https://api.github.com/users/fxn/received_events", "followers_url": "https://api.github.com/users/fxn/followers"}, "body": "Well, the commit message says there's one less variable, but the number of variables stays the same right?\r\n\r\nThe number of operations superficially seems smaller, but you can't really compare because it depends on the implementation of `inject`.\r\n\r\nIndeed, for nestings of size 2 or 3 the `each` version is a little bit faster\r\n\r\n```ruby\r\nrequire 'benchmark'\r\n\r\nmodule A\r\n  module B\r\n    module C\r\n    end\r\n  end\r\nend\r\n\r\ndef with_each(names)\r\n  constant = Object\r\n  names.each do |name|\r\n    constant = constant.const_get(name, false)\r\n  end\r\n  constant\r\nend\r\n\r\ndef with_inject(names)\r\n  names.inject(Object) do |constant, name|\r\n    constant.const_get(name, false)\r\n  end\r\nend\r\n\r\nNAMES = %w(A B C)\r\nBenchmark.bm do |bm|\r\n  bm.report(:each)   { 10000.times { with_each(NAMES) } }\r\n  bm.report(:inject) { 10000.times { with_inject(NAMES) } }\r\nend\r\n__END__\r\nfxn@cauchy:~/tmp $ ruby1.9 foo.rb\r\n       user     system      total        real\r\neach  0.020000   0.000000   0.020000 (  0.014777)\r\ninject  0.020000   0.000000   0.020000 (  0.019295)\r\n```\r\n\r\nI don't mind the commit, not a fan of `inject` but it is fine. But I'd like to point out this is a stylistic/abstraction refactor rather than what the commit message says.", "_id": {"$oid": "52381b51bd3543c15100e3e0"}, "html_url": "https://github.com/rails/rails/pull/5208#issuecomment-4237887"}
