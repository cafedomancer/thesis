{"body": "I've observed people being tripped up by it on more than one occasion. Because of `rails s -e special-development` I would expect to type `rails c -e special-development` not `rails c special-development`. It seems pointlessly inconsistent. Fixing this bug adds a small method. It's a nice bonus, but it could be removed if isn't necessary. Most people probably know it doesn't work by now.\n\nThe main reason for this patch though was the bug introduced in Rails 3 where the environment argument is ignored if it includes a hyphen anywhere in the string. There were no tests for this code (which I've discovered had at least 3 bugs), so I moved it in to a class and added tests for what was the original intended behaviour.\n\nAnother nice side effect is that it removes the duplication in console.rb and dbconsole.rb (and could possibly be extended to other commands like server.rb)\n\nA simpler approach could be fixing the hyphen bug at https://github.com/rails/rails/blob/master/railties/lib/rails/commands/console.rb#L87 and adding tests something like this:\n\n```\n def test_console_with_hyphens_in_environment_name\n    with_rails_env nil do\n      with_argv [\"special-production\"] do\n        load 'rails/commands/console.rb'\n        assert_equal 'special-production', ENV['RAILS_ENV']\n      end\n    end\n  end\n```\n\nReloading the file to test the behaviour feels like a bit of a hack, there would still be duplication (and the `-e` option should of course be removed from the option documentation) but it's slightly simpler (maybe?).", "url": "https://api.github.com/repos/rails/rails/issues/comments/5675624", "created_at": "2012-05-13T11:32:42Z", "html_url": "https://github.com/rails/rails/pull/6276#issuecomment-5675624", "updated_at": "2012-05-13T11:33:22Z", "repo": "rails", "issue_id": 6276, "user": {"following_url": "https://api.github.com/users/samoli/following{/other_user}", "events_url": "https://api.github.com/users/samoli/events{/privacy}", "organizations_url": "https://api.github.com/users/samoli/orgs", "url": "https://api.github.com/users/samoli", "gists_url": "https://api.github.com/users/samoli/gists{/gist_id}", "html_url": "https://github.com/samoli", "subscriptions_url": "https://api.github.com/users/samoli/subscriptions", "avatar_url": "https://1.gravatar.com/avatar/a6ad943eee0cec3804b89bc7bf865293?d=https%3A%2F%2Fidenticons.github.com%2F5ce55aca7691670cc15a805d6b071a49.png", "repos_url": "https://api.github.com/users/samoli/repos", "received_events_url": "https://api.github.com/users/samoli/received_events", "gravatar_id": "a6ad943eee0cec3804b89bc7bf865293", "starred_url": "https://api.github.com/users/samoli/starred{/owner}{/repo}", "login": "samoli", "type": "User", "id": 15641, "followers_url": "https://api.github.com/users/samoli/followers"}, "owner": "rails", "_id": {"$oid": "52380bebbd3543c15100d093"}, "id": 5675624, "issue_url": "https://api.github.com/repos/rails/rails/issues/6276"}
