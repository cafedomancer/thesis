{"updated_at": "2012-04-23T04:55:05Z", "repo": "rails", "created_at": "2012-04-23T04:55:05Z", "owner": "rails", "url": "https://api.github.com/repos/rails/rails/issues/comments/5274349", "id": 5274349, "issue_url": "https://api.github.com/repos/rails/rails/issues/5927", "issue_id": 5927, "user": {"repos_url": "https://api.github.com/users/avakhov/repos", "type": "User", "html_url": "https://github.com/avakhov", "starred_url": "https://api.github.com/users/avakhov/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/avakhov/subscriptions", "following_url": "https://api.github.com/users/avakhov/following{/other_user}", "gravatar_id": "54e74983d81fa2fbe4c28e8392532f18", "organizations_url": "https://api.github.com/users/avakhov/orgs", "url": "https://api.github.com/users/avakhov", "gists_url": "https://api.github.com/users/avakhov/gists{/gist_id}", "avatar_url": "https://2.gravatar.com/avatar/54e74983d81fa2fbe4c28e8392532f18?d=https%3A%2F%2Fidenticons.github.com%2Fedb3b863d9333073200581afe223ec23.png", "id": 92554, "events_url": "https://api.github.com/users/avakhov/events{/privacy}", "login": "avakhov", "received_events_url": "https://api.github.com/users/avakhov/received_events", "followers_url": "https://api.github.com/users/avakhov/followers"}, "body": "I meant that if we get clean master and apply parameters swapping + force float point operations for ActiveSupport durations:\r\n\r\n``` ruby\r\ndistance_in_minutes = ((to_time - from_time)/60).round # --- remove\r\ndistance_in_minutes = ((to_time - from_time)/60.0).round # +++ add\r\n```\r\n\r\nyour tests from #5710 will be passed without any additional changes. I prepare example: https://github.com/avakhov/rails/commit/cb632e56820ce242cb1e6d775dc48b33546273bb\r\n\r\n```\r\n~/m/github/rails/actionpack(1.9.3-p0-ff)[5710-another]$ ruby -Itest test/template/date_helper_test.rb \r\nRun options: --seed 44240\r\n\r\n# Running tests:\r\n\r\n......................................................................................................................................................................................\r\n\r\nFinished tests in 6.350915s, 28.6573 tests/s, 67.3919 assertions/s.\r\n\r\n182 tests, 428 assertions, 0 failures, 0 errors, 0 skips\r\n```\r\n\r\nI'm sorry. AS means AsctiveSupport. If you use `59.seconds` actually you get ActiveSupport::Duration object. It's rather tricky wrapper about Fixnum (`2.yeas` is Float however). `distance_of_time_in_words` works well for time intervals, because `time1 - time2` is Float and `59.0/60 == 0.98333`, but is broken for AS distances because of 59/60 == 0.\r\n\r\nWe just should force using float arithmetic to get your tests work proper. Parameters swapping helps leap years trick to work right.", "_id": {"$oid": "52381144bd3543c15100d7a3"}, "html_url": "https://github.com/rails/rails/pull/5927#issuecomment-5274349"}
