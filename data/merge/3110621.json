{"body": "I think this commit introduces some issues.\r\n\r\nPreviously to these changes, when I executed `rake db:test:clone_structure`\r\nthe structure was dumped (to structure.sql) and then loaded again no matter whether\r\nthe  `config.active_record.schema_format` was set to :sql or :ruby. That was OK\r\nbecause I'm explicitly saying that I want the structure to be cloned.\r\n\r\nWith these changes, when I call now the same task, although the structure is\r\ndumped, the loaded schema depends on the value of the\r\n`config.active_record.schema_format`. So If I have it set to :ruby and then I\r\ncall `rake db:test:clone_structure` the loaded file is schema.rb and not the\r\nstructure.sql how it is supposed to be according to the name of the task and\r\nits description.\r\n\r\nThe same thing happens when I call `rake db:test:clone`. When called,\r\na new schema.rb is created but the file used to load the schema depends on\r\n`config.active_record.schema_format`. If I have it set to :sql, a new schema.rb\r\nis created but the structure.sql file is used to create the database. So it is\r\nnot consistent.\r\n\r\nI didn't create an issue/pull-request because I wanted to discuss it here first,\r\nbut in case we decide to make some changes, I think we could do something like this:\r\n\r\nhttps://github.com/Juanmcuello/rails/commit/88a4aeacddf1bb051ff2115b761ed24de4bbe993", "url": "https://api.github.com/repos/rails/rails/issues/comments/3110621", "created_at": "2011-12-12T19:00:03Z", "html_url": "https://github.com/rails/rails/pull/2948#issuecomment-3110621", "updated_at": "2011-12-19T15:45:19Z", "repo": "rails", "issue_id": 2948, "user": {"following_url": "https://api.github.com/users/Juanmcuello/following{/other_user}", "events_url": "https://api.github.com/users/Juanmcuello/events{/privacy}", "organizations_url": "https://api.github.com/users/Juanmcuello/orgs", "url": "https://api.github.com/users/Juanmcuello", "gists_url": "https://api.github.com/users/Juanmcuello/gists{/gist_id}", "html_url": "https://github.com/Juanmcuello", "subscriptions_url": "https://api.github.com/users/Juanmcuello/subscriptions", "avatar_url": "https://1.gravatar.com/avatar/f63a259f9b2375e2e900b8cfcc1420fd?d=https%3A%2F%2Fidenticons.github.com%2F6ab50a3e04f83906aac563629a76f88d.png", "repos_url": "https://api.github.com/users/Juanmcuello/repos", "received_events_url": "https://api.github.com/users/Juanmcuello/received_events", "gravatar_id": "f63a259f9b2375e2e900b8cfcc1420fd", "starred_url": "https://api.github.com/users/Juanmcuello/starred{/owner}{/repo}", "login": "Juanmcuello", "type": "User", "id": 112913, "followers_url": "https://api.github.com/users/Juanmcuello/followers"}, "owner": "rails", "_id": {"$oid": "52383d4bbd3543c151010475"}, "id": 3110621, "issue_url": "https://api.github.com/repos/rails/rails/issues/2948"}
