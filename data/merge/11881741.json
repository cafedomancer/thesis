{"updated_at": "2013-01-04T12:44:14Z", "repo": "rails", "created_at": "2013-01-04T12:44:14Z", "owner": "rails", "url": "https://api.github.com/repos/rails/rails/issues/comments/11881741", "id": 11881741, "issue_url": "https://api.github.com/repos/rails/rails/issues/5515", "issue_id": 5515, "user": {"repos_url": "https://api.github.com/users/gtd/repos", "type": "User", "html_url": "https://github.com/gtd", "starred_url": "https://api.github.com/users/gtd/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/gtd/subscriptions", "following_url": "https://api.github.com/users/gtd/following{/other_user}", "gravatar_id": "bc7e893b6d4605000478c871b7ce8862", "organizations_url": "https://api.github.com/users/gtd/orgs", "url": "https://api.github.com/users/gtd", "gists_url": "https://api.github.com/users/gtd/gists{/gist_id}", "avatar_url": "https://0.gravatar.com/avatar/bc7e893b6d4605000478c871b7ce8862?d=https%3A%2F%2Fidenticons.github.com%2F2b0aa0d9e30ea3a55fc271ced8364536.png", "id": 5603, "events_url": "https://api.github.com/users/gtd/events{/privacy}", "login": "gtd", "received_events_url": "https://api.github.com/users/gtd/received_events", "followers_url": "https://api.github.com/users/gtd/followers"}, "body": "The bottom half of the middleware:\r\n\r\n      # http://tools.ietf.org/html/draft-hodges-strict-transport-sec-02\r\n      def hsts_headers\r\n        if @hsts\r\n          value = \"max-age=#{@hsts[:expires]}\"\r\n          value += \"; includeSubDomains\" if @hsts[:subdomains]\r\n          { 'Strict-Transport-Security' => value }\r\n        else\r\n          {}\r\n        end\r\n      end\r\n\r\n      def flag_cookies_as_secure!(headers)\r\n        if cookies = headers['Set-Cookie']\r\n          cookies = cookies.split(\"\\n\")\r\n\r\n          headers['Set-Cookie'] = cookies.map { |cookie|\r\n            if cookie !~ /; secure(;|$)/\r\n              \"#{cookie}; secure\"\r\n            else\r\n              cookie\r\n            end\r\n          }.join(\"\\n\")\r\n        end\r\n      end", "_id": {"$oid": "523816ecbd3543c15100df16"}, "html_url": "https://github.com/rails/rails/pull/5515#issuecomment-11881741"}
