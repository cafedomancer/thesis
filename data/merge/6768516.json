{"issue_url": "https://api.github.com/repos/rails/rails/issues/6952", "repo": "rails", "body": "To clarify the purpose here, we're *not* looking at using this for passwords.  The bcrypt gem does that much more transparently and simply than we could here.\n\nThe goal is instead to let us derive multiple keys from a single application secret.\n\nCurrently we have:\n\n```ruby\nconfig.secret_token = \"af60a5492cabefa4f84707919d84354c5f7a7cfcd978f977ff16af4aaea4678b14b48f705f6cff7cd86706fd837dd9e2d00fb06e9bd74fa2e615f8a1787faac1\"\n```\n\nIn every generated app, we use that for signing cookies and the cookie store.  However we want to make it possible to ship an encrypted cookie store, which requires an encryption key *and* a secret.  \n\nWe also want to make it possible for users to generate their own `MessageVerifier`s and `MessageEncryptor`s.\n\nOn the advice of the google security guys, we don't want to use the same secret as both the encryption key.  As a result we need a deterministic way to generate additional keys based on the secret and another value.  That's the intended use of the `KeyGenerator` here.\n\nWhen we sign cookies, we won't use the raw secret_token, we'll instead use:\n\n```ruby\n  cookie_secret = Application.key_generator.derive_key(some_salt)\n```\n\nThe salts will either be generated when your app is generated, or perhaps even just defaulting to static values like \"cookie hmac secret\", \"cookie encryption key\".\n\nSo, is that a bit clearer?  Additionally, does that plan make *any* sense? ;)", "_id": {"$oid": "52380195bd3543c15100c170"}, "issue_id": 6952, "url": "https://api.github.com/repos/rails/rails/issues/comments/6768516", "html_url": "https://github.com/rails/rails/pull/6952#issuecomment-6768516", "updated_at": "2012-07-04T22:04:07Z", "user": {"subscriptions_url": "https://api.github.com/users/NZKoz/subscriptions", "events_url": "https://api.github.com/users/NZKoz/events{/privacy}", "repos_url": "https://api.github.com/users/NZKoz/repos", "gists_url": "https://api.github.com/users/NZKoz/gists{/gist_id}", "url": "https://api.github.com/users/NZKoz", "login": "NZKoz", "gravatar_id": "efa76b164a7de4a5730e4fa397cc4425", "html_url": "https://github.com/NZKoz", "following_url": "https://api.github.com/users/NZKoz/following{/other_user}", "received_events_url": "https://api.github.com/users/NZKoz/received_events", "organizations_url": "https://api.github.com/users/NZKoz/orgs", "avatar_url": "https://0.gravatar.com/avatar/efa76b164a7de4a5730e4fa397cc4425?d=https%3A%2F%2Fidenticons.github.com%2F85d8ce590ad8981ca2c8286f79f59954.png", "starred_url": "https://api.github.com/users/NZKoz/starred{/owner}{/repo}", "id": 197, "followers_url": "https://api.github.com/users/NZKoz/followers", "type": "User"}, "created_at": "2012-07-04T22:04:07Z", "id": 6768516, "owner": "rails"}
