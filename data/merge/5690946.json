{"body": "`RAILS_ENV` needs to be set before config/application.rb is loaded (before Rails::Console.start is called). \n\nIf the OptionParser is moved to a class method it would need to be called after the class definition and before Rails.application.require_environment!.\n\nSomething like:\n\n`rails/commands.rb:37`\n\n```ruby\nwhen 'console'\n  require 'rails/commands/console'\n  options = Rails::Console.parse_options(ARGV)\n  require APP_PATH\n  Rails.application.require_environment!\n  Rails::Console.start(Rails.application, options)\n```\n\nThat would remove the need for the regexp. What do you think?", "url": "https://api.github.com/repos/rails/rails/issues/comments/5690946", "created_at": "2012-05-14T14:06:52Z", "html_url": "https://github.com/rails/rails/pull/6276#issuecomment-5690946", "updated_at": "2012-05-14T14:06:52Z", "repo": "rails", "issue_id": 6276, "user": {"following_url": "https://api.github.com/users/samoli/following{/other_user}", "events_url": "https://api.github.com/users/samoli/events{/privacy}", "organizations_url": "https://api.github.com/users/samoli/orgs", "url": "https://api.github.com/users/samoli", "gists_url": "https://api.github.com/users/samoli/gists{/gist_id}", "html_url": "https://github.com/samoli", "subscriptions_url": "https://api.github.com/users/samoli/subscriptions", "avatar_url": "https://1.gravatar.com/avatar/a6ad943eee0cec3804b89bc7bf865293?d=https%3A%2F%2Fidenticons.github.com%2F5ce55aca7691670cc15a805d6b071a49.png", "repos_url": "https://api.github.com/users/samoli/repos", "received_events_url": "https://api.github.com/users/samoli/received_events", "gravatar_id": "a6ad943eee0cec3804b89bc7bf865293", "starred_url": "https://api.github.com/users/samoli/starred{/owner}{/repo}", "login": "samoli", "type": "User", "id": 15641, "followers_url": "https://api.github.com/users/samoli/followers"}, "owner": "rails", "_id": {"$oid": "52380bebbd3543c15100d096"}, "id": 5690946, "issue_url": "https://api.github.com/repos/rails/rails/issues/6276"}
